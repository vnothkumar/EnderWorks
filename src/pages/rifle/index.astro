---
import { getCollection } from "astro:content";
import Posts from "../../components/Posts.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";

const allPosts = await getCollection("products");
const filteredPosts = allPosts.filter((post) =>
  post.data.tags?.includes("rifle")
);

const sorted = filteredPosts.sort(
  (a, b) =>
    new Date(b.data.created_at).valueOf() -
    new Date(a.data.created_at).valueOf()
);
---

<BaseLayout title="" description="Browse our rifle collection">
  <div class="w-full px-4 lg:px-8 py-6">
    <h1 class="text-2xl lg:text-3xl font-bold tracking-tight mb-2">ðŸ”« Rifles</h1>
    <p class="text-base-content/70 mb-6">Browse our collection of precision rifles and accessories</p>
  </div>
  
  <Posts
    posts={sorted.map((post) => ({
      id: post.id,
      slug: post.id,
      data: {
        title: post.data.title,
        images: post.data.images,
        description: post.data.description,
        created_at: post.data.created_at,
        price: post.data.price,
        tags: post.data.tags,
      },
    }))}
  />
</BaseLayout>
